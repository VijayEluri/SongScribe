<?xml version="1.0" encoding="ISO-8859-1"?>
<project name="songscribe" default="dist">
    <property name="output.dir" value="${basedir}/classes_temp"/>
    <property name="jarfile" value="songscribe.jar"/>
    <property name="dist" value="${basedir}/dist"/>
    <property name="ss" value="${dist}/ss"/>

    <path id="classpath">
        <pathelement location="${basedir}/libs/log4j-1.2.9.jar"/>
        <pathelement location="${basedir}/libs/itext-1.4.jar"/>
        <pathelement location="${basedir}/libs/swing-layout.jar"/>
        <pathelement location="${basedir}/libs/AppleJavaExtensions.jar"/>
        <pathelement location="${basedir}/libs/commons-httpclient-3.1.jar"/>
        <pathelement location="${basedir}/libs/commons-logging-1.1.jar"/>
        <pathelement location="${basedir}/libs/commons-codec-1.3.jar"/>
        <pathelement location="${basedir}/libs/jdc.jar"/>
    </path>

    <target name="dist">
        <copy todir="${ss}/conf">
            <fileset dir="${basedir}/conf" excludes=".svn"/>
        </copy>
        <copy todir="${ss}/fonts">
            <fileset dir="${basedir}/fonts" excludes=".svn"/>
        </copy>
	    <copy todir="${ss}/examples">
            <fileset dir="${basedir}/examples" excludes=".svn"/>
        </copy>
        <copy todir="${ss}/help">
            <fileset dir="${basedir}/help" excludes=".svn"/>
        </copy>
        <copy todir="${ss}/images">
            <fileset dir="${basedir}/images" excludes=".svn"/>
        </copy>
        <copy todir="${ss}/libs">
            <fileset dir="${basedir}/libs" excludes=".svn"/>
        </copy>
        <copy todir="${ss}/profiles">
            <fileset dir="${basedir}/profiles" excludes=".svn"/>            
        </copy>
        <copy todir="${ss}/thirdpartylicenses">
            <fileset dir="${basedir}/thirdpartylicenses" excludes=".svn"/>
        </copy>        
        <copy todir="${ss}">
            <fileset file="license.txt"/>
            <fileset file="readme.html"/>
	        <fileset file="launching.txt"/>
            <fileset file="songscribe.jar"/>
        </copy>
        <java classname="songscribe.ChecksumMaker" dir="${ss}" fork="true">
            <classpath refid="classpath"/>
            <classpath location="${jarfile}"/>
        </java>
        <java classname="songscribe.VersionWriter" output="${ss}/version">
            <classpath refid="classpath"/>
            <classpath location="${jarfile}"/>
            <arg value="full"/>
        </java>
        <java classname="songscribe.VersionWriter" outputproperty="updateversion">
            <classpath refid="classpath"/>
            <classpath location="${jarfile}"/>
            <arg value="update"/>
        </java>

        <!--Making the tar.gz platform independent file-->

        <!--property name="tarfile" value="${basedir}/songscribe_${updateversion}.tar"/>
        <property name="temp_ss" value="${dist}/songscribe"/>
        <move file="${ss}" tofile="${temp_ss}"/>
        <tar destfile="${tarfile}" basedir="${dist}"/>
        <gzip src="${tarfile}" destfile="${tarfile}.gz"/>
        <delete file="${tarfile}"/-->

        <!--Making the tar.gz platform independent with sources file-->

        <!--property name="tarsrcfile" value="${basedir}/songscribe_src_${updateversion}.tar"/>
        <copy todir="${temp_ss}/src">
                <fileset dir="${basedir}/src" excludes=".svn"/>
            </copy>
        <copy file="${basedir}/build.xml" todir="${temp_ss}"/>
        <tar destfile="${tarsrcfile}" basedir="${dist}"/>
        <gzip src="${tarsrcfile}" destfile="${tarsrcfile}.gz"/>
        <delete file="${tarsrcfile}"/>

        <move file="${tarfile}.gz" todir="${dist}"/>
        <move file="${tarsrcfile}.gz" todir="${dist}"/>
        <delete dir="${temp_ss}/src"/>
        <delete file="${temp_ss}/build.xml"/>
        <move file="${temp_ss}" tofile="${ss}"/-->
	
	    <!--Making the update file-->
        
        <!--zip destfile="${dist}/ssupdate_${updateversion}.msu">
            <fileset dir="${ss}"/>
        </zip-->

        <!--Deleting the stuff for update-->
        <java classname="songscribe.UpdateMaker">
            <classpath refid="classpath"/>
            <classpath location="${jarfile}"/>
            <arg value="${ss}"/>
        </java>
    </target>
</project>